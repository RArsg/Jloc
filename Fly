-- نظام الطيران EVERLAST - النسخة المميزة
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- إنشاء واجهة التحكم
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "EVERLASTFlightControl"
screenGui.Parent = game:GetService("CoreGui")
screenGui.ResetOnSpawn = false

-- إطار التحكم الرئيسي
local controlFrame = Instance.new("Frame")
controlFrame.Name = "ControlFrame"
controlFrame.Parent = screenGui
controlFrame.Size = UDim2.new(0, 250, 0, 180)
controlFrame.Position = UDim2.new(0.7, 0, 0.6, 0)
controlFrame.BackgroundColor3 = Color3.fromRGB(10, 30, 10) -- أخضر غامق
controlFrame.BackgroundTransparency = 0.1
controlFrame.BorderSizePixel = 3
controlFrame.BorderColor3 = Color3.fromRGB(0, 255, 0) -- أخضر فاتح
controlFrame.Active = true
controlFrame.Draggable = true

-- عنوان النظام
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Parent = controlFrame
title.Size = UDim2.new(1, 0, 0.15, 0)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(0, 80, 0) -- أخضر داكن
title.Text = "طيران EVERLAST"
title.TextColor3 = Color3.fromRGB(0, 255, 0) -- أخضر فاتح
title.Font = Enum.Font.GothamBold
title.TextSize = 18

-- منطقة التحكم في السرعة
local speedFrame = Instance.new("Frame")
speedFrame.Name = "SpeedFrame"
speedFrame.Parent = controlFrame
speedFrame.Size = UDim2.new(1, 0, 0.3, 0)
speedFrame.Position = UDim2.new(0, 0, 0.15, 0)
speedFrame.BackgroundTransparency = 1

-- عرض السرعة الحالية
local speedDisplay = Instance.new("TextLabel")
speedDisplay.Name = "SpeedDisplay"
speedDisplay.Parent = speedFrame
speedDisplay.Size = UDim2.new(0.4, 0, 1, 0)
speedDisplay.Position = UDim2.new(0.3, 0, 0, 0)
speedDisplay.BackgroundColor3 = Color3.fromRGB(0, 40, 0) -- أخضر داكن
speedDisplay.Text = "السرعة: 50"
speedDisplay.TextColor3 = Color3.fromRGB(0, 255, 0) -- أخضر فاتح
speedDisplay.Font = Enum.Font.GothamBold
speedDisplay.TextSize = 14

-- أزرار تغيير السرعة
local speedUpBtn = Instance.new("TextButton")
speedUpBtn.Name = "SpeedUp"
speedUpBtn.Parent = speedFrame
speedUpBtn.Size = UDim2.new(0.2, 0, 1, 0)
speedUpBtn.Position = UDim2.new(0.7, 0, 0, 0)
speedUpBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 0) -- أخضر
speedUpBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
speedUpBtn.Text = "+"
speedUpBtn.Font = Enum.Font.GothamBold
speedUpBtn.TextSize = 20

local speedDownBtn = Instance.new("TextButton")
speedDownBtn.Name = "SpeedDown"
speedDownBtn.Parent = speedFrame
speedDownBtn.Size = UDim2.new(0.2, 0, 1, 0)
speedDownBtn.Position = UDim2.new(0.1, 0, 0, 0)
speedDownBtn.BackgroundColor3 = Color3.fromRGB(180, 0, 0) -- أحمر
speedDownBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
speedDownBtn.Text = "-"
speedDownBtn.Font = Enum.Font.GothamBold
speedDownBtn.TextSize = 20

-- أزرار التحكم في الحركة
local controlGrid = Instance.new("Frame")
controlGrid.Name = "ControlGrid"
controlGrid.Parent = controlFrame
controlGrid.Size = UDim2.new(1, 0, 0.45, 0)
controlGrid.Position = UDim2.new(0, 0, 0.45, 0)
controlGrid.BackgroundTransparency = 1

-- تعريف أزرار التحكم
local controlButtons = {
    Forward = {Text = "أمام", Position = UDim2.new(0.35, 0, 0, 0), Color = Color3.fromRGB(0, 150, 0)},
    Left = {Text = "يسار", Position = UDim2.new(0, 0, 0.35, 0), Color = Color3.fromRGB(0, 120, 0)},
    Right = {Text = "يمين", Position = UDim2.new(0.7, 0, 0.35, 0), Color = Color3.fromRGB(0, 120, 0)},
    Backward = {Text = "خلف", Position = UDim2.new(0.35, 0, 0.7, 0), Color = Color3.fromRGB(0, 150, 0)},
    Up = {Text = "أعلى", Position = UDim2.new(0.8, 0, 0, 0), Color = Color3.fromRGB(0, 200, 0), Size = UDim2.new(0.4, 0, 0.3, 0)},
    Down = {Text = "أسفل", Position = UDim2.new(0.8, 0, 0.35, 0), Color = Color3.fromRGB(150, 0, 0), Size = UDim2.new(0.4, 0, 0.3, 0)}
}

local buttons = {}

for name, config in pairs(controlButtons) do
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Parent = controlGrid
    btn.Size = config.Size or UDim2.new(0.3, 0, 0.3, 0)
    btn.Position = config.Position
    btn.BackgroundColor3 = config.Color
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Text = config.Text
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 12
    btn.BorderSizePixel = 2
    btn.BorderColor3 = Color3.fromRGB(0, 80, 0) -- حدود خضراء
    
    -- تأثير الضغط
    btn.MouseButton1Down:Connect(function()
        btn.BackgroundColor3 = Color3.fromRGB(255, 255, 100) -- أصفر عند الضغط
        btn.TextColor3 = Color3.fromRGB(0, 0, 0)
    end)
    
    btn.MouseButton1Up:Connect(function()
        btn.BackgroundColor3 = config.Color
        btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    end)
    
    buttons[name] = btn
end

-- زر تفعيل/إلغاء الطيران
local toggleBtn = Instance.new("TextButton")
toggleBtn.Name = "ToggleFlight"
toggleBtn.Parent = controlFrame
toggleBtn.Size = UDim2.new(0.9, 0, 0.1, 0)
toggleBtn.Position = UDim2.new(0.05, 0, 0.9, 0)
toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0) -- أخضر
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Text = "تفعيل الطيران"
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 14

-- زر الإغلاق
local closeBtn = Instance.new("TextButton")
closeBtn.Name = "Close"
closeBtn.Parent = screenGui
closeBtn.Size = UDim2.new(0, 40, 0, 40)
closeBtn.Position = UDim2.new(0.7, 210, 0.6, 0)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50) -- أحمر
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Text = "✕"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 20

-- متغيرات نظام الطيران
local isFlying = false
local currentSpeed = 50
local flightBodyVelocity = nil
local flightBodyGyro = nil

-- متغيرات التحكم
local moveForward = false
local moveBackward = false
local moveLeft = false
local moveRight = false
local moveUp = false
local moveDown = false

-- تحديث عرض السرعة
local function updateSpeedDisplay()
    speedDisplay.Text = "السرعة: " .. currentSpeed
end

-- تهيئة نظام الطيران
local function setupFlightSystem()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    
    -- إنشاء أدوات الطيران
    flightBodyVelocity = Instance.new("BodyVelocity")
    flightBodyVelocity.Name = "FlightVelocity"
    flightBodyVelocity.MaxForce = Vector3.new(40000, 40000, 40000)
    flightBodyVelocity.P = 10000
    
    flightBodyGyro = Instance.new("BodyGyro")
    flightBodyGyro.Name = "FlightGyro"
    flightBodyGyro.MaxTorque = Vector3.new(40000, 40000, 40000)
    flightBodyGyro.P = 10000
    
    return humanoidRootPart
end

-- تفعيل الطيران
local function activateFlight(rootPart)
    isFlying = true
    toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 255, 0) -- أخضر فاتح
    toggleBtn.Text = "الطيران مفعل"
    
    -- تثبيت أدوات الطيران
    flightBodyVelocity.Parent = rootPart
    flightBodyGyro.Parent = rootPart
    
    -- تعطيل الجاذبية على الشخصية
    local humanoid = player.Character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.PlatformStand = true
    end
    
    -- إضافة قوة مضادة للجاذبية
    local antiGravity = Instance.new("BodyForce")
    antiGravity.Name = "AntiGravity"
    antiGravity.Force = Vector3.new(0, workspace.Gravity * player.Character:GetMass(), 0)
    antiGravity.Parent = rootPart
    
    -- إشعار التفعيل
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "طيران EVERLAST",
        Text = "تم تفعيل نظام الطيران",
        Duration = 3
    })
end

-- إلغاء الطيران
local function deactivateFlight(rootPart)
    isFlying = false
    toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0) -- أخضر
    toggleBtn.Text = "تفعيل الطيران"
    
    -- إزالة أدوات الطيران
    flightBodyVelocity.Parent = nil
    flightBodyGyro.Parent = nil
    
    -- إعادة تفعيل الجاذبية
    local humanoid = player.Character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.PlatformStand = false
    end
    
    -- إزالة القوة المضادة للجاذبية
    local antiGravity = rootPart:FindFirstChild("AntiGravity")
    if antiGravity then
        antiGravity:Destroy()
    end
    
    -- إعادة تعيين متغيرات الحركة
    moveForward = false
    moveBackward = false
    moveLeft = false
    moveRight = false
    moveUp = false
    moveDown = false
    
    -- إعادة تعيين ألوان الأزرار
    for name, btn in pairs(buttons) do
        btn.BackgroundColor3 = controlButtons[name].Color
    end
end

-- تحكم الأزرار
buttons.Forward.MouseButton1Down:Connect(function() moveForward = true end)
buttons.Forward.MouseButton1Up:Connect(function() moveForward = false end)

buttons.Backward.MouseButton1Down:Connect(function() moveBackward = true end)
buttons.Backward.MouseButton1Up:Connect(function() moveBackward = false end)

buttons.Left.MouseButton1Down:Connect(function() moveLeft = true end)
buttons.Left.MouseButton1Up:Connect(function() moveLeft = false end)

buttons.Right.MouseButton1Down:Connect(function() moveRight = true end)
buttons.Right.MouseButton1Up:Connect(function() moveRight = false end)

buttons.Up.MouseButton1Down:Connect(function() moveUp = true end)
buttons.Up.MouseButton1Up:Connect(function() moveUp = false end)

buttons.Down.MouseButton1Down:Connect(function() moveDown = true end)
buttons.Down.MouseButton1Up:Connect(function() moveDown = false end)

-- تحكم لوحة المفاتيح
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.W then
        moveForward = true
    elseif input.KeyCode == Enum.KeyCode.S then
        moveBackward = true
    elseif input.KeyCode == Enum.KeyCode.A then
        moveLeft = true
    elseif input.KeyCode == Enum.KeyCode.D then
        moveRight = true
    elseif input.KeyCode == Enum.KeyCode.Space then
        moveUp = true
    elseif input.KeyCode == Enum.KeyCode.LeftControl then
        moveDown = true
    end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.W then
        moveForward = false
    elseif input.KeyCode == Enum.KeyCode.S then
        moveBackward = false
    elseif input.KeyCode == Enum.KeyCode.A then
        moveLeft = false
    elseif input.KeyCode == Enum.KeyCode.D then
        moveRight = false
    elseif input.KeyCode == Enum.KeyCode.Space then
        moveUp = false
    elseif input.KeyCode == Enum.KeyCode.LeftControl then
        moveDown = false
    end
end)

-- تحديث السرعة
speedUpBtn.MouseButton1Click:Connect(function()
    currentSpeed = math.min(currentSpeed + 5, 200)
    updateSpeedDisplay()
end)

speedDownBtn.MouseButton1Click:Connect(function()
    currentSpeed = math.max(currentSpeed - 5, 5)
    updateSpeedDisplay()
end)

-- تفعيل/إلغاء الطيران
local rootPart = setupFlightSystem()
toggleBtn.MouseButton1Click:Connect(function()
    if isFlying then
        deactivateFlight(rootPart)
    else
        activateFlight(rootPart)
    end
end)

-- تحديث حركة الطيران
local flightUpdateConnection = RunService.Heartbeat:Connect(function(delta)
    if not isFlying or not flightBodyVelocity or not flightBodyGyro then return end
    
    local character = player.Character
    if not character then return end
    
    local root = character:FindFirstChild("HumanoidRootPart")
    if not root then return end
    
    -- الحصول على اتجاه الكاميرا
    local camera = workspace.CurrentCamera
    local cameraCFrame = camera.CFrame
    
    -- حساب اتجاه الحركة
    local moveDirection = Vector3.new(0, 0, 0)
    
    -- أمام/خلف بالنسبة للكاميرا
    if moveForward then
        moveDirection = moveDirection + cameraCFrame.LookVector
    end
    if moveBackward then
        moveDirection = moveDirection - cameraCFrame.LookVector
    end
    
    -- يمين/يسار بالنسبة للكاميرا
    if moveRight then
        moveDirection = moveDirection + cameraCFrame.RightVector
    end
    if moveLeft then
        moveDirection = moveDirection - cameraCFrame.RightVector
    end
    
    -- أعلى/أسفل
    if moveUp then
        moveDirection = moveDirection + Vector3.new(0, 1, 0)
    end
    if moveDown then
        moveDirection = moveDirection - Vector3.new(0, 1, 0)
    end
    
    -- تطبيع الاتجاه وتطبيق السرعة
    if moveDirection.Magnitude > 0 then
        moveDirection = moveDirection.Unit * currentSpeed
    else
        -- تثبيت في المكان إذا لم يكن هناك حركة
        moveDirection = Vector3.new(0, 0.1, 0) -- بقاء معلق في الهواء
    end
    
    -- تطبيق السرعة
    flightBodyVelocity.Velocity = moveDirection
    
    -- توجيه الشخصية مع الكاميرا
    flightBodyGyro.CFrame = CFrame.new(root.Position, root.Position + cameraCFrame.LookVector)
    
    -- تحديث ألوان الأزرار بناءً على الحالة
    buttons.Forward.BackgroundColor3 = moveForward and Color3.fromRGB(0, 255, 100) or Color3.fromRGB(0, 150, 0)
    buttons.Backward.BackgroundColor3 = moveBackward and Color3.fromRGB(0, 255, 100) or Color3.fromRGB(0, 150, 0)
    buttons.Left.BackgroundColor3 = moveLeft and Color3.fromRGB(0, 255, 100) or Color3.fromRGB(0, 120, 0)
    buttons.Right.BackgroundColor3 = moveRight and Color3.fromRGB(0, 255, 100) or Color3.fromRGB(0, 120, 0)
    buttons.Up.BackgroundColor3 = moveUp and Color3.fromRGB(0, 255, 100) or Color3.fromRGB(0, 200, 0)
    buttons.Down.BackgroundColor3 = moveDown and Color3.fromRGB(255, 100, 100) or Color3.fromRGB(150, 0, 0)
end)

-- معالجة إعادة ظهور الشخصية
player.CharacterAdded:Connect(function(character)
    task.wait(1) -- انتظار تحميل الشخصية
    rootPart = character:WaitForChild("HumanoidRootPart")
    
    if isFlying then
        deactivateFlight(rootPart)
        activateFlight(rootPart)
    end
end)

-- زر الإغلاق
closeBtn.MouseButton1Click:Connect(function()
    if isFlying then
        deactivateFlight(rootPart)
    end
    
    flightUpdateConnection:Disconnect()
    screenGui:Destroy()
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "طيران EVERLAST",
        Text = "تم إغلاق النظام",
        Duration = 3
    })
end)

-- إضافة تأثير إضاءة للواجهة
local glowEffect = Instance.new("UIStroke")
glowEffect.Parent = controlFrame
glowEffect.Color = Color3.fromRGB(0, 255, 0)
glowEffect.Thickness = 2
glowEffect.Transparency = 0.5

-- إضافة تأثير التوهج للعنوان
local titleGlow = Instance.new("UIStroke")
titleGlow.Parent = title
titleGlow.Color = Color3.fromRGB(0, 255, 0)
titleGlow.Thickness = 2

-- إشعار البدء
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "نظام الطيران EVERLAST",
    Text = "تم تفعيل نظام التحكم المميز\nاستخدم الأزرار أو مفاتيح W/A/S/D/Space/Ctrl",
    Duration = 5
})

print("نظام الطيران EVERLAST مفعل!")
